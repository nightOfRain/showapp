<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<link href="css/lib/bootstrap/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="css/lib/jQueryMobile/jquery.mobile-1.4.3.css" />
<link href="css/index.css" rel="stylesheet">
<link rel="stylesheet" href="common/slick/slick.css">
<link href="js/lib/bootstrap3.0/bootstrap.css" rel="stylesheet">
<link href="css/lib/zzlcss/menu11.css" rel="stylesheet">
<link href="css/common.css" rel="stylesheet">

<script type="text/javascript" src="js/lib/jQuery/jquery-2.0.0.min.js"></script>
<script type="text/javascript" src="js/lib/bootstrap/bootstrap.min.js"></script>
<script type="text/javascript" src="cordova.js"></script> 
<script src="js/index.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="js/jquery.js"></script> 
<script type="text/javascript" src="js/jquery.md5.js"></script>

<title></title>
<style type="text/css">
.inp_text {
	border: 0 !important;
	background: none !important;
	box-shadow: none !important;
	line-height: 35px !important;
	color: #5b5b5b !important;
	width: 160px !important;
	font-size: 15px;
}
.tp1
{
	width:20px;
	height:25px;
	
	
}
.tp2
{
	width:20px;
	height:20px;
	margin-left:30px;
	
}
body { 
margin: 0; 
padding: 0; 
 /* prevent screen flash in IE6 */
 height: 100%;
 width:100%;
 background: -webkit-linear-gradient(top, rgba(227, 160, 93, 0.8) 0%, rgba(56, 13, 49, 0.6) 100%);
 background: linear-gradient(to bottom, rgba(227, 160, 93, 0.8) 0%, rgba(56, 13, 49, 0.6) 100%);
 -webkit-transition: opacity 0.1s, -webkit-transform 0.3s cubic-bezier(0.17, -0.65, 0.665, 1.25);
 transition: opacity 0.1s, transform 0.3s cubic-bezier(0.17, -0.65, 0.665, 1.25);
 -webkit-transform: scale(1);
 -ms-transform: scale(1);
 transform: scale(1);
}
div,ul{margin: 0;padding: 0;}
.topNavWrapper { 
width: 100%; 
text-align: left; 
height: 31px; 
margin: 0px auto; 
z-index:100; 
_position: relative ; 
_top:0px; 
} 
.topNav { 
width: 100%; 
float: left; 
display: block; 
z-index: 100; 
overflow: visible; 
/*position: fixed;/ 
top: 0px; /* position fixed for IE6 */ 
_position: relative ; 
_top: expression(documentElement.scrollTop + "px"); 
background-repeat: no-repeat; 
background-position: right; 
height: 31px; 
line-height: 31px; 
color:#fff; 
background-color:#444; 
text-align:center; 
}
.rgt {
	width: 10px;
	height: 18px;
	float: right;
	margin-right: 20px;
	margin-top: 12px;
	background-size: 100% 100%;
	background-image: url("img/right.png");
}
.left{float:left;width:50%;margin-top:10px;font-weight:bold;background-color:rgba(240,255,240,0.0);}

.right{float:right;width:50%;margin-top:10px;font-weight:bold;background-color:rgba(240,255,240,0.0);}

.button {
    display: inline-block;
    position: relative;
    margin: 10px;
    padding: 0 20px;
    text-align: center;
    text-decoration: none;
    font: bold 12px/25px Arial, sans-serif;
    
    text-shadow: 1px 1px 1px rgba(255,255,255, .22);
    
    -webkit-border-radius: 30px;
    -moz-border-radius: 30px;
    border-radius: 30px;
    
    -webkit-box-shadow: 1px 1px 1px rgba(0,0,0, .29), inset 1px 1px 1px rgba(255,255,255, .44);
    -moz-box-shadow: 1px 1px 1px rgba(0,0,0, .29), inset 1px 1px 1px rgba(255,255,255, .44);
    box-shadow: 1px 1px 1px rgba(0,0,0, .29), inset 1px 1px 1px rgba(255,255,255, .44);
    
    -webkit-transition: all 0.15s ease;
    -moz-transition: all 0.15s ease;
    -o-transition: all 0.15s ease;
    -ms-transition: all 0.15s ease;
    transition: all 0.15s ease;
}
.blue {
    color: #19667d;
    
    background: #70c9e3; /* Old browsers */
    background: -moz-linear-gradient(top,  #70c9e3 0%, #39a0be 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#70c9e3), color-stop(100%,#39a0be)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #70c9e3 0%,#39a0be 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #70c9e3 0%,#39a0be 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #70c9e3 0%,#39a0be 100%); /* IE10+ */
    background: linear-gradient(top,  #70c9e3 0%,#39a0be 100%); /* W3C */
}
.big {
    padding: 0 40px;
   
    height: 45px;
    text-transform: uppercase;
    font: bold 20px/22px Arial, sans-serif;
}

.big span {
    display: block;
    text-transform: none;
    font: italic normal 12px/18px Georgia, sans-serif;
    text-shadow: 1px 1px 1px rgba(255,255,255, .12);
}
</style>
<script type="text/javascript">
	var thisURL;
	var flag;
	var userid;
	var My_h;
	var password;
	var IP="139.224.70.151";
	var PORT="9999";
//	document.addEventListener("backbutton", onBackKeyDown, false); //返回键  
	document.addEventListener("DOMContentLoaded", initial);
	function initial() {
		thisURL = document.URL; 
		localStorage.setItem("thisURL", thisURL);
		localStorage.setItem("acount", "0");
        localStorage.setItem("hiscount", "0");
        localStorage.setItem("pagenum", "0")
     //   document.getElementsByTagName('body')[0].style.width = window.screen.availWidth+"px";
      //  document.getElementsByTagName('body')[0].style.height = window.screen.availHeight-20+"px";
        var userno = localStorage.getItem("userid");
        if(userno){
            $("#userid").val(userno);
            $("#mm").val(localStorage.getItem("password"));
        }
//        localStorage.clear();
	}

	function onBackKeyDown() {
		if( window.confirm("确认退出世纪天源APP吗?")){
			navigator.app.exitApp(); 
			clearInterval(intervalid);
		}
	}
	function login(){

	//	var data = {};
  
		userid = $("#userid").val();
		password = $("#mm").val();		
		//alert("userid="+userid+";password="+password);
		var mm = $.md5(password);
        if( userid == '' || password == ''){
            alertInfo('用户号或密码不能为空');
        }
		NTParameter.addValue(null, null, "userid", userid);
        NTParameter.addValue(null, null, "password", password);
		localStorage.setItem("acount", 0);

		var data = {};
		data.userid = $("#userid").val();
		
		localStorage.setItem("userid", data.userid);
        localStorage.setItem("password", password);
		data.password =  $.md5(password);
	
		
		
		start_process();
			$.ajax({
				type : "post",
				timeout: 10000,
				url: "http://"+IP+":"+PORT+"/app/6001",
				data : data,
				datatype : "json",
				success : jugelog,
				error:function(msg){
					stop_process();
					alertInfo('登录失败');
				}
			});
		}
	function jugelog(msg){
		
		stop_process();
		var json=eval("("+msg+")");
		
		localStorage.setItem("login_info",msg);
		var userid = $("#userid").val();
		localStorage.setItem("userid", userid);
		
		if( json.stat == '0') //登陆成功
		{			
			
			if( userid.length == 11 ) //外部手机号客户
			{
				localStorage.setItem("level", 0);
				
			} else {
				
                
				localStorage.setItem("username", json.data.accountName);
				localStorage.setItem("accountOrgn", json.data.accountOrgn);
				localStorage.setItem("accountType", json.data.accountType);
				localStorage.setItem("orgnName", json.data.orgnName);
				
				
				localStorage.setItem("orgnType", json.data.orgnType);
				localStorage.setItem("accountPosition", json.data.accountPosition);
				//localStorage.setItem("sessionid", json.data.jsessionid);
			//	localStorage.setItem("allCompany", json.data.allCompany);
			//	localStorage.setItem("allPosition", json.data.allPosition);
		
				
				for(var i = 0; i < json.data.allPosition.length; i++){
					if(json.data.accountPosition == json.data.allPosition[i].post_id){
						localStorage.setItem("pos_name", json.data.allPosition[i].post_name);
						
					}
				}
				var pos = json.data.accountPosition; //0-管理层 1-普通员工
				var hzjg_type = json.data.orgnType; //0-总公司 1-分公司 2-合作机构 3-门店
				var type = json.data.accountType; //1-领导 2-员工
				var level;
				
                if(hzjg_type == '0' || hzjg_type =='1') //总公司
                {
                    if(pos == 'A' || pos == 'B' || pos == 'J')//只有签单员和驻行员能创建案卷
                        level = 3;
                    else if(pos == 'N' || pos == 'E' || pos == 'L')
                        level = 1;
                    else
                        level = 2;
                }else if(hzjg_type=='2' || hzjg_type=='3'){
                    
                     if(pos == 'X1' || pos == 'Y1')
                        level = 4;
                     else
                        level = 5;
                }else {
                    level == 0;
                }
                
				localStorage.setItem("level",level);
                
				/*业绩排名*/
				var pm;
		        var mes='';
		        if( json.data.undo > 0){
		        	mes= '您有 ' + json.data.undo + ' 条待处理事件;';
		        }
		        
				if(json.data.rank1.length > 0 ){ //分公司排名
					for(var i = 0; i < json.data.rank1.length; i++){
						
						localStorage.setItem("gr_pm_"+json.data.rank1[i].rank_type2, json.data.rank1[i].rank_no);
					}	
					if(pos == 'A' || pos == 'B' || pos == 'F'){
		            	 pm = json.data.rank1[0].rank_no;
		            	 if(pm > 0){
			            	 mes += "您本周面签量排名 "+ pm+"位";
			             }
		             }
				}
				if(json.data.rank2.length > 0 ){ //分公司排名
					for(var i = 0; i < json.data.rank2.length; i++){
						
						localStorage.setItem("fgs_pm_"+json.data.rank2[i].rank_type, json.data.rank2[i].rank_no);
					}	
					if(pos != 'A' && pos != 'B' && pos != 'F'){
		            	 pm = json.data.rank2[0].rank_no;
		            	 if(pm > 0){
		            		 mes += "分公司面签量排名 "+ pm+"位";
			             }
		             }
				}
				if(mes!='' ){
					alertInfo(mes);
				}
			}
			
			NTParameter.addValue(null, null, "userid", userid);
			
			window.location.href="index.html";
            //window.location.href="touch_test.html";
		}else{
			alertInfo("登录失败:"+json.msg);
		}
	}
	 function start_process(){
	    	//MyProcess.start();
	    	NTUI.beginLoaded();
	    	
	    }
	    
	    function stop_process(){
	    	NTUI.onLoaded();
	    	//MyProcess.stop();
	    }
	 function alertInfo(message){
		 navigator.notification.alert(message, null, "世纪源金融", "确定");
	    }
 
	function zhuce(){
		localStorage.setItem("hiscount", "1");
		window.location.href="grzlzc.html"; 
	}
	
	function wjmm(){
		localStorage.setItem("hiscount", "1");
		window.location.href="wjmm.html"; 
	}
	
	

</script>   
</head>

<body style="background-image:Url('img/bj2.png');background-size:cover;overflow:hidden;">


<div class="container-fluid" style="margin-top:265px;">

<div  class="" style="margin-top:18px;">

	
	<div  >
	
		<ul>
			<li style="line-height:50px;height:50px;border-bottom: 2px solid #ffffff;width:60%;margin-left:20%;">
				<div style="margin-top:15px;" >
				
					<img src="img/password.png" style="width:28px;" align="absmiddle" class="tp1" /> 
					<!-- <span style="margin-left:10px;margin-right:35px;font-size:19px;" >用户名</span> -->
					<input type="text"   class="inp_text_new" style="font-size: 17px;margin-left:20px;margin-right:10px;margin-top:15px;" id="userid"/>
				</div>
			</li>
			<li style="line-height:50px;height:50px;border-bottom: 2px solid #ffffff;width:60%;margin-left:20%;">
				<div style="margin-top:15px;" > 
					<img  src="img/user.png"  style="width:28px;" align="absmiddle"  class="tp1" /> 
					<!--  <span style="margin-left:10px;margin-right:35px;font-size:19px;" >密&nbsp;&nbsp;&nbsp;&nbsp;码</span>-->
					<input type="password"  class="inp_text_new" style="font-size: 17px;margin-left:20px;margin-right:10px;margin-top:15px;" id="mm"/>
				</div>
			</li>
		</ul>
	</div>
	
	
	<div class="row" style="margin-top:15px;">
		<div class="col-xs-6 text-right">
		<!-- 	<button id="button_grdk" class="button blue big"  onclick="login()">登录</button> -->
				<img src="img/login.png" style="height:40px;margin-right:10px;" onclick="login()"></img>
		</div>
		
		<div class="col-xs-6 text-left">
			<!--<button  id="button_qydk" class="button blue big"  onclick="zhuce()">注册</button> -->
			<img src="img/sign.png" style="height:40px;margin-left:10px;" onclick="zhuce()"></img>
		</div>
	</div>
	
	<div class="col-xs-12 text-center" style="margin-top:8px;">
		<span style="font-size:14px;color: #3A006F;font-weight:bold" onclick="wjmm()">忘记密码</span>
	</div>
	

</div>

</div>

</body>

</html>
